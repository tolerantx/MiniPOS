.row
  .span9
    - model_class = Ticket
    .page-hader
      %h1= t('.title', :default => model_class.model_name.human.pluralize.titleize)

    = form_tag tickets_path, :method => :get, :id => 'tickets-search-form', :class => 'well form-inline' do
      %label
        %strong= t("labels.search")
      = text_field_tag 'search[terms]', @search[:terms], :placeholder => t("placeholder.search")
      %label
        %strong= t("labels.state")
      = select_tag 'search[state]', options_for_select(Ticket::STATES, :selected => params[:search] ? params[:search][:state] : ""), { :include_blank => true }
      = submit_tag 'Buscar', :id => 'tickets-form-button', :class => 'btn btn-small btn-primary'
      = link_to t('labels.clear'), tickets_path, :class => 'btn btn-small'


    %table.table.table-hover.table-striped.table-condensed
      %thead
        %tr
          %th= model_class.human_attribute_name(:id)
          %th= t("activerecord.models.customer")
          %th= model_class.human_attribute_name(:total)
          %th= model_class.human_attribute_name(:state)
          %th= model_class.human_attribute_name(:created_at)
          %th= t '.actions', :default => t("helpers.actions")
      %tbody
        - @tickets.each do |ticket|
          %tr
            %td
              = link_to ticket.id, ticket_path(ticket)
            %td
              = ticket.recipient.full_name if ticket.recipient
            %td
              = number_to_currency ticket.total
            %td
              %span{:class => "btn btn-mini disabled #{state_highlight(ticket)}"}
                = t("ticket_state.#{ticket.state}")
            %td
              = l ticket.created_at, :format => :short
            %td
              = link_to t('.show', :default => t("helpers.links.show")),
                          ticket_path(ticket), :class => 'btn btn-mini btn-warning'
              = link_to t('ticket_state.deliver'),
                          deliver_ticket_path(ticket),
                          :data => { :confirm => t('ticket_state.confirm.deliver') },
                          :class => 'btn btn-mini btn-success' if ticket.created?
              = link_to t('ticket_state.cancel'),
                          cancel_ticket_path(ticket),
                          :data => { :confirm => t('ticket_state.confirm.cancel') },
                          :class => 'btn btn-mini btn-danger' if ticket.created? || ticket.delivered?


    = pagination @tickets

  .span3
    .text-right
      = link_to t('.new', :default => t("helpers.links.new")), new_ticket_path, :class => 'btn btn-primary'

    .block
      %h5= t("labels.general_information")
      %p
        %strong= t("labels.total_records")
        = @tickets.count
